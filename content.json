{"meta":{"title":"少停","subtitle":null,"description":"愿天堂没有bug","author":null,"url":"https://pheromone.github.io"},"pages":[{"title":"categories","date":"2018-05-16T05:42:13.079Z","updated":"2018-03-18T03:30:29.519Z","comments":true,"path":"categories/index.html","permalink":"https://pheromone.github.io/categories/index.html","excerpt":"","text":""},{"title":"关于我","date":"2018-04-07T08:32:49.056Z","updated":"2018-04-07T07:31:15.567Z","comments":true,"path":"about/index.html","permalink":"https://pheromone.github.io/about/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-05-15T18:39:35.260Z","updated":"2018-03-18T03:30:47.370Z","comments":true,"path":"tags/index.html","permalink":"https://pheromone.github.io/tags/index.html","excerpt":"","text":""},{"title":"留言板","date":"2018-04-01T02:32:51.298Z","updated":"2018-04-01T02:32:51.290Z","comments":true,"path":"message/index.html","permalink":"https://pheromone.github.io/message/index.html","excerpt":"","text":""},{"title":"search","date":"2018-04-07T08:31:05.000Z","updated":"2018-04-07T08:31:05.277Z","comments":true,"path":"search/index.html","permalink":"https://pheromone.github.io/search/index.html","excerpt":"","text":""}],"posts":[{"title":"react-navigation前置登录","slug":"移动端学习/react-navigation前置登录","date":"2018-06-15T16:00:00.000Z","updated":"2018-06-16T06:36:06.531Z","comments":true,"path":"2018/06/16/移动端学习/react-navigation前置登录/","link":"","permalink":"https://pheromone.github.io/2018/06/16/移动端学习/react-navigation前置登录/","excerpt":"好多应用都需要涉及到前置登录,今天就来实操一下.所用的库有react-natigation导航库和mobx状态管理库.","text":"好多应用都需要涉及到前置登录,今天就来实操一下.所用的库有react-natigation导航库和mobx状态管理库. 这里贴一下各库的使用版本: 123456789101112131415161718192021222324252627 &#123; &quot;name&quot;: &quot;lead_the_login&quot;, &quot;version&quot;: &quot;0.0.1&quot;, &quot;private&quot;: true, &quot;scripts&quot;: &#123; &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;, &quot;test&quot;: &quot;jest&quot; &#125;, &quot;dependencies&quot;: &#123; &quot;mobx&quot;: &quot;^4.3.0&quot;, &quot;mobx-react&quot;: &quot;^5.1.2&quot;, &quot;react&quot;: &quot;16.3.1&quot;, &quot;react-native&quot;: &quot;0.55.4&quot;, &quot;react-navigation&quot;: &quot;1.5.3&quot; &#125;, &quot;devDependencies&quot;: &#123; &quot;babel-jest&quot;: &quot;23.0.1&quot;, &quot;babel-plugin-transform-decorators-legacy&quot;: &quot;^1.3.5&quot;, &quot;babel-preset-react-native&quot;: &quot;4.0.0&quot;, &quot;babel-preset-react-native-stage-0&quot;: &quot;^1.0.1&quot;, &quot;jest&quot;: &quot;23.1.0&quot;, &quot;react-test-renderer&quot;: &quot;16.3.1&quot; &#125;, &quot;jest&quot;: &#123; &quot;preset&quot;: &quot;react-native&quot; &#125;&#125; 前置登录主要使用的是react-navigation的tabbar的点击事件. 使用方法可以看 react navigation官方网站 或者 兔佬的简书,至于mbox和react-navigation的使用可以参考之前写的这篇文章:Mobx和react-navigation的使用. 这里不做细说.直接上代码.下面是基本代码结构.准备工作,先把mobx+react-navigation搭建完毕之后.我们在点击我的Tab时,对tabBar点击事件做处理即可,在点击事件里面先获取我们存在Store中的登录状态,根据状态做不同的事情,这里我未处理本地数据持久化工作,只是单纯的存在Mobx中的store中,是为了方便其他地方使用.实际开发中,我们还需要对数据进行持久化操作.主要代码有:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;import &#123; observer, inject &#125; from &apos;mobx-react&apos;import &#123; action, autorun, computed &#125; from &apos;mobx&apos;import &#123; NavigationActions &#125; from &apos;react-navigation&apos;const resetAction = NavigationActions.reset(&#123; index: 0, actions: [ NavigationActions.navigate(&#123;routeName: &apos;Tab&apos;, params: &#123;&#125;&#125;) ]&#125;)@inject(&apos;rootStore&apos;)@observerexport default class TwoView extends Component&lt;Props&gt; &#123; static navigationOptions = (&#123; navigation &#125;) =&gt; (&#123; header:null, tabBarOnPress: (tab) =&gt; &#123; //让tabBar可点击,做前置登录 // navigation.state.params.navigatePress() tab.jumpToIndex(tab.scene.index) &#125;, &#125;); render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text&gt; 登录状态:&#123;this.loginStatus ? &apos;已经登录&apos; : &apos;未登录&apos;&#125; &lt;/Text&gt; &lt;Text onPress=&#123;()=&gt;this.loginOutAction()&#125;&gt; 注销 &lt;/Text&gt; &lt;/View&gt; ); &#125; @computed get loginStatus() &#123; return this.props.rootStore.TwoStore.allDatas.loginStatus; &#125; componentDidMount() &#123; this.props.navigation.setParams(&#123; navigatePress: this.needLogin() &#125;) // 使用这个来调用this &#125; /** * 判断是否需要登录 * */ needLogin =() =&gt;&#123; //判断登录 console.log(&apos;loginStatus&apos;) console.log(this.loginStatus) if(this.loginStatus)&#123; //已经登录 return; &#125;else &#123; //未登录 跳转至登录界面 this.props.navigation.navigate(&apos;LoginView&apos;,&#123;callback:()=&gt;this.getPersonalInfo()&#125;) &#125; &#125; /** * 登录成功的回调方法 * */ getPersonalInfo =() =&gt;&#123; // 请求数据赋值即可 &#125; loginOutAction =() =&gt;&#123; //注销登录 清空本地化数据 和 重置store中的loginStatus this.props.rootStore.TwoStore.allDatas.loginStatus = false this.props.navigation.dispatch(resetAction); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); 和登录之后修改store中状态123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;import &#123; observer, inject &#125; from &apos;mobx-react&apos;import &#123; action, autorun, computed &#125; from &apos;mobx&apos;@inject(&apos;rootStore&apos;)@observerexport default class LoginView extends Component&lt;Props&gt; &#123; static navigationOptions = (&#123; navigation &#125;) =&gt; (&#123; header:null, &#125;); render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text onPress=&#123;()=&gt;this.loginAction()&#125;&gt; 登录 &lt;/Text&gt; &lt;/View&gt; ); &#125; /** * 登录/注销 可以在store里面执行也可以直接在这里执行,看你习惯 * */ loginAction =() =&gt;&#123; //登录请求 //成功之后,修改loginStatus.本地化数据等等 this.props.rootStore.TwoStore.allDatas.loginStatus = true //返回上一个界面,并回调刷新 this.props.navigation.goBack() this.props.navigation.state.params.callback(); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); 效果如图:源码","categories":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/categories/移动端学习/"}],"tags":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/tags/移动端学习/"}]},{"title":"Mobx + react-navigation的使用","slug":"移动端学习/Mobx-react-navigation的使用","date":"2018-05-26T16:00:00.000Z","updated":"2018-05-27T11:23:33.596Z","comments":true,"path":"2018/05/27/移动端学习/Mobx-react-navigation的使用/","link":"","permalink":"https://pheromone.github.io/2018/05/27/移动端学习/Mobx-react-navigation的使用/","excerpt":"今天,学习下RN中的另外一个全家桶套餐架构:Mobx+React-Navigation,本文基于react-native:0.55.4,Mbox:^4.3.0,react-navigation:^2.0.1所撸.","text":"今天,学习下RN中的另外一个全家桶套餐架构:Mobx+React-Navigation,本文基于react-native:0.55.4,Mbox:^4.3.0,react-navigation:^2.0.1所撸.Mbox中文文档另外一个基于Mbox和react-navigation的不错项目 废话不多缩,首先,新建一个项目,添加相应库:npm i mobx mobx-react --save 引入Mbox npm i babel-plugin-transform-decorators-legacy babel-preset-react-native-stage-0 --save-dev 能够使用@标签 npm i react-navigation --save 引入导航库然后修改一下工程里面的.babelrc: 1234&#123; &quot;presets&quot;: [&quot;react-native&quot;], &quot;plugins&quot;: [&quot;transform-decorators-legacy&quot;]&#125; OK,基本的架子已经搭好.然后新建一个src目录.这里存放基本代码和基本图片之类的. 然后,在入口文件App.js中,先搭建tabBar和导航条.使用react-navigation这里,我使用全局注册并注入mobx，其他地方都可以使用store.import {Provider} from &#39;mobx-react&#39;;然后在src-&gt;Mobx这里新建一个根store的Store.js文件.Store.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import &#123; observable, computed, action &#125; from &apos;mobx&apos;import oneInfo from &apos;./OneInfo&apos;import twoInfo from &apos;./TwoInfo&apos;/** * 根store * OneInfo OneInfo数据 * TwoInfo TwoInfo数据*/class RootStore &#123; constructor() &#123; this.OneInfo = new OneInfo(oneInfo,this) this.TwoInfo = new TwoInfo(twoInfo,this) &#125;&#125;// Oneclass OneInfo &#123; @observable allDatas = [] constructor(data,rootStore) &#123; this.allDatas = data this.rootStore = rootStore &#125; //加 @action add(num) &#123; this.allDatas.oneNum = num + 1 this.rootStore.TwoInfo.allDatas.twoColor = &apos;red&apos; &#125; //减 @action sub(num) &#123; this.allDatas.oneNum = num - 1 this.rootStore.TwoInfo.allDatas.twoColor = &apos;blue&apos; &#125;&#125;// Twoclass TwoInfo &#123; @observable allDatas = &#123;&#125; constructor(data,rootStore) &#123; this.allDatas = data this.rootStore = rootStore &#125;&#125;export default new RootStore() 另外:OneInfo.js 123456789const OneInfo = &#123; &quot;data&quot;: [ ], &quot;isOne&quot; : true, &quot;oneNum&quot; : 0&#125;export default OneInfo; TwoInfo.js 123456789const TwoInfo = &#123; &quot;data&quot;: [ ], &quot;isTwo&quot; : false, &quot;twoColor&quot;:&apos;white&apos;&#125;export default TwoInfo; ok,回到App.js中: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105import React, &#123;Component&#125; from &apos;react&apos;;import &#123;Platform, StyleSheet, Text, View, Image&#125; from &apos;react-native&apos;;import &#123;StackNavigator, TabNavigator, TabBarBottom&#125; from &apos;react-navigation&apos;;// 全局注册并注入mobx，其他地方都可以使用storeimport &#123;Provider&#125; from &apos;mobx-react&apos;;// 获取store实例import store from &apos;./src/Mobx/Store&apos;;import One from &apos;./src/One/One&apos;;import Two from &apos;./src/Two/Two&apos;;export default class TwoDetails extends Component&lt;Props&gt; &#123; render () &#123; return ( &lt;Provider rootStore=&#123;store&#125;&gt; &lt;Navigator onNavigationStateChange=&#123;(prevState, currentState) =&gt; &#123; // 只要切换tab,push,pop,这里一定走 console.log (prevState); console.log (currentState); &#125;&#125; /&gt; &lt;/Provider&gt; ); &#125; componentDidMount = () =&gt; &#123; console.disableYellowBox = true; //去除黄色弹框警告 &#125;;&#125;const Tab = TabNavigator ( &#123; One: &#123; screen: One, navigationOptions: (&#123;navigation&#125;) =&gt; (&#123; tabBarLabel: &apos;男孩&apos;, tabBarIcon: (&#123;focused, tintColor&#125;) =&gt; ( &lt;Image source=&#123; focused ? require (&apos;./src/Image/boy_active.png&apos;) : require (&apos;./src/Image/boy.png&apos;) &#125; style=&#123;&#123;width: 25, height: 25&#125;&#125; /&gt; ), &#125;), &#125;, Two: &#123; screen: Two, navigationOptions: (&#123;navigation&#125;) =&gt; (&#123; tabBarLabel: &apos;女孩&apos;, tabBarIcon: (&#123;focused, tintColor&#125;) =&gt; ( &lt;Image source=&#123; focused ? require (&apos;./src/Image/girl_active.png&apos;) : require (&apos;./src/Image/girl.png&apos;) &#125; style=&#123;&#123;width: 25, height: 25&#125;&#125; /&gt; ), &#125;), &#125;, &#125;, &#123; tabBarComponent: TabBarBottom, tabBarPosition: &apos;bottom&apos;, swipeEnabled: true, animationEnabled: true, lazy: true, tabBarOptions: &#123; activeTintColor: &apos;#979797&apos;, inactiveTintColor: &apos;#979797&apos;, style: &#123;backgroundColor: &apos;#ffffff&apos;&#125;, &#125;, &#125;);const Navigator = StackNavigator (&#123; Tab: &#123; screen: Tab, &#125;,&#125;);const styles = StyleSheet.create (&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); 然后就是基本的UI界面了:One.js 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;import &#123; observer, inject &#125; from &apos;mobx-react&apos;import &#123; action, autorun, computed &#125; from &apos;mobx&apos;@inject(&apos;rootStore&apos;)@observerexport default class One extends Component&lt;Props&gt; &#123; // 构造 constructor(props) &#123; super(props); // 初始状态 this.state = &#123;&#125;; &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text onPress=&#123;()=&gt;this.add()&#125;&gt; + 红 &lt;/Text&gt; &lt;Text&gt; One &#123;this.dataSource&#125; &lt;/Text&gt; &lt;Text onPress=&#123;()=&gt;this.sub()&#125;&gt; - 蓝 &lt;/Text&gt; &lt;/View&gt; ); &#125; @computed get dataSource() &#123; return this.props.rootStore.OneInfo.allDatas.oneNum; &#125; /** * + * */ @action add() &#123; this.props.rootStore.OneInfo.add(this.dataSource) &#125; /** * - * */ @action sub() &#123; this.props.rootStore.OneInfo.sub(this.dataSource) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); Two.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;import &#123; observer, inject &#125; from &apos;mobx-react&apos;import &#123; action, autorun, computed &#125; from &apos;mobx&apos;@inject(&apos;rootStore&apos;)@observerexport default class Two extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;View style=&#123;[styles.container,&#123;backgroundColor:this.bgColor&#125;]&#125;&gt; &lt;Text&gt; TWO &lt;/Text&gt; &lt;/View&gt; ); &#125; @computed get bgColor() &#123; return this.props.rootStore.TwoInfo.allDatas.twoColor; &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); ok,以上就是Mbox+react-navigation的Demo的基本代码了.效果图: 源码 另外:redux+react-navigation","categories":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/categories/移动端学习/"}],"tags":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/tags/移动端学习/"}]},{"title":"后端学习","slug":"后端学习/后端学习","date":"2018-03-18T08:18:48.245Z","updated":"2018-05-16T05:31:45.728Z","comments":true,"path":"2018/03/18/后端学习/后端学习/","link":"","permalink":"https://pheromone.github.io/2018/03/18/后端学习/后端学习/","excerpt":"加紧施工中…","text":"加紧施工中…","categories":[{"name":"后端学习","slug":"后端学习","permalink":"https://pheromone.github.io/categories/后端学习/"}],"tags":[{"name":"后端学习","slug":"后端学习","permalink":"https://pheromone.github.io/tags/后端学习/"}]},{"title":"其他学习","slug":"其他学习/其他学习","date":"2018-03-18T08:18:48.245Z","updated":"2018-05-16T05:25:38.036Z","comments":true,"path":"2018/03/18/其他学习/其他学习/","link":"","permalink":"https://pheromone.github.io/2018/03/18/其他学习/其他学习/","excerpt":"加紧施工中…","text":"加紧施工中…","categories":[{"name":"其他学习","slug":"其他学习","permalink":"https://pheromone.github.io/categories/其他学习/"}],"tags":[{"name":"其他学习","slug":"其他学习","permalink":"https://pheromone.github.io/tags/其他学习/"}]},{"title":"Android和React Native的简单交互","slug":"移动端学习/Android和React Native的简单交互","date":"2018-03-18T08:18:48.245Z","updated":"2018-05-16T05:51:33.638Z","comments":true,"path":"2018/03/18/移动端学习/Android和React Native的简单交互/","link":"","permalink":"https://pheromone.github.io/2018/03/18/移动端学习/Android和React Native的简单交互/","excerpt":"首先在Android原生中.新建class文件TransMissonMoudle:","text":"首先在Android原生中.新建class文件TransMissonMoudle: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108/** * Created by shaotingzhou on 2018/3/7. */package com.androidrn.RN;import com.facebook.react.bridge.Callback;import com.facebook.react.bridge.Promise;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.bridge.ReactContext;import com.facebook.react.bridge.ReactContextBaseJavaModule;import com.facebook.react.bridge.ReactMethod;import com.facebook.react.bridge.WritableMap;import com.facebook.react.bridge.WritableNativeMap;import com.facebook.react.modules.core.DeviceEventManagerModule;import java.text.SimpleDateFormat;import java.util.Date;import javax.annotation.Nullable;public class TransMissonMoudle extends ReactContextBaseJavaModule &#123; private static final String REACT_CLASS = &quot;TransMissonMoudle&quot;; private ReactContext mReactContext; public TransMissonMoudle(ReactApplicationContext reactContext) &#123; super(reactContext); this.mReactContext = reactContext; &#125; @Override public String getName() &#123; return REACT_CLASS; &#125; //延迟0.1秒获取时间。 @ReactMethod public void getTime() &#123; new Thread(new Runnable() &#123; @Override public void run() &#123; try &#123; Thread.sleep(100); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; String time = getTimeMillis(); WritableMap writableMap = new WritableNativeMap(); writableMap.putString(&quot;key&quot;, time); sendTransMisson(mReactContext, &quot;EventName&quot;, writableMap); &#125; &#125;).start(); &#125; private String getTimeMillis() &#123; SimpleDateFormat formatDate = new SimpleDateFormat(&quot;yyyy年MM月dd日 HH:mm:ss&quot;); Date date = new Date(System.currentTimeMillis()); String time = formatDate.format(date); return time; &#125; /** * RCTDeviceEventEmitter方式 * * @param reactContext * @param eventName 事件名 * @param params 传惨 */ public void sendTransMisson(ReactContext reactContext, String eventName, @Nullable WritableMap params) &#123; reactContext .getJSModule(DeviceEventManagerModule.RCTDeviceEventEmitter.class) .emit(eventName, params); &#125; /** * CallBack方式 * * @param name * @param callback */ @ReactMethod public void callBackTime(String name, Callback callback) &#123; callback.invoke(getTimeMillis()); &#125; /** * Promise方式 * @param name * @param promise */ @ReactMethod public void sendPromiseTime(String name, Promise promise) &#123; WritableMap writableMap=new WritableNativeMap(); writableMap.putString(&quot;age&quot;,&quot;20&quot;); writableMap.putString(&quot;time&quot;,getTimeMillis()); promise.resolve(writableMap); &#125;&#125; 再建class文件TransMissonPackage: 1234567891011121314151617181920212223242526272829303132333435363738package com.androidrn.RN;import com.facebook.react.ReactPackage;import com.facebook.react.bridge.JavaScriptModule;import com.facebook.react.bridge.NativeModule;import com.facebook.react.bridge.ReactApplicationContext;import com.facebook.react.uimanager.ViewManager;import java.util.ArrayList;import java.util.Collections;import java.util.List;/** * Created by shaotingzhou on 2018/3/7. */public class TransMissonPackage implements ReactPackage &#123; @Override public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) &#123; List&lt;NativeModule&gt; modules = new ArrayList&lt;&gt;(); modules.add(new TransMissonMoudle(reactContext));//摇一摇 return modules; &#125;// @Override// public List&lt;Class&lt;? extends JavaScriptModule&gt;&gt; createJSModules() &#123;// return Collections.emptyList();// &#125; @Override public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) &#123; List&lt;ViewManager&gt; viewManagerList=new ArrayList&lt;&gt;();// viewManagerList.add(new PTRRefreshManager()); return viewManagerList; &#125;&#125; 接着在MainApplication里引入TransMissonPackage,加入包.如 import com.androidrn.RN.TransMissonPackage; new TransMissonPackage()123456789101112131415161718192021222324252627282930313233343536373839404142434445464748package com.androidrn;import android.app.Application;import com.androidrn.RN.TransMissonPackage;import com.facebook.react.ReactApplication;import com.facebook.react.ReactNativeHost;import com.facebook.react.ReactPackage;import com.facebook.react.shell.MainReactPackage;import com.facebook.soloader.SoLoader;import java.util.Arrays;import java.util.List;public class MainApplication extends Application implements ReactApplication &#123; private final ReactNativeHost mReactNativeHost = new ReactNativeHost(this) &#123; @Override public boolean getUseDeveloperSupport() &#123; return BuildConfig.DEBUG; &#125; @Override protected List&lt;ReactPackage&gt; getPackages() &#123; return Arrays.&lt;ReactPackage&gt;asList( new MainReactPackage(), new TransMissonPackage() ); &#125; @Override protected String getJSMainModuleName() &#123; return &quot;index&quot;; &#125; &#125;; @Override public ReactNativeHost getReactNativeHost() &#123; return mReactNativeHost; &#125; @Override public void onCreate() &#123; super.onCreate(); SoLoader.init(this, /* native exopackage */ false); &#125;&#125; 我的文件放置情况如图: 然后只需要在RN这边:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123;Component&#125; from &apos;react&apos;;import &#123; AppRegistry, StyleSheet, Text, View, DeviceEventEmitter, NativeModules, ToastAndroid, Platform&#125; from &apos;react-native&apos;;const instructions = Platform.select(&#123; ios: &apos;Press Cmd+R to reload,\\n&apos; + &apos;Cmd+D or shake for dev menu&apos;, android: &apos;Double tap R on your keyboard to reload,\\n&apos; + &apos;Shake or press menu button for dev menu&apos;,&#125;);type Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; componentWillMount() &#123; DeviceEventEmitter.addListener(&apos;EventName&apos;, function (msg) &#123; console.log(&apos;DeviceEventEmitter收到消息&apos;+msg); alert(&apos;DeviceEventEmitter收到消息&apos;+ msg.key) &#125;); &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.getDeviceEventEmitterTime.bind(this)&#125; &gt; RCTDeviceEventEmitter获取时间 &lt;/Text&gt; &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.getCallBackTime.bind(this)&#125; &gt; CallBack获取时间 &lt;/Text&gt; &lt;Text style=&#123;styles.welcome&#125; onPress=&#123;this.getPromiseTime.bind(this)&#125; &gt; Promise获取时间 &lt;/Text&gt; &lt;/View&gt; ); &#125; getDeviceEventEmitterTime() &#123; NativeModules.TransMissonMoudle.getTime(); &#125; getCallBackTime() &#123; NativeModules.TransMissonMoudle.callBackTime(&quot;Allure&quot;, (msg) =&gt; &#123; console.log(&apos;callBack:---&apos; + msg); alert(&apos;callBack:---&apos;+msg) &#125; ); &#125; getPromiseTime() &#123; NativeModules.TransMissonMoudle.sendPromiseTime(&quot;Allure&quot;).then(msg=&gt; &#123; console.log(&quot;年龄:&quot; + msg.age + &quot;/n&quot; + &quot;时间:&quot; + msg.time); alert(&quot;年龄&quot; + msg.age + &quot;时间&quot; + msg.time) this.setState(&#123; age: msg.age, time: msg.time, &#125;) &#125;).catch(error=&gt; &#123; console.log(&apos;错误&apos; + error); &#125;); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); 源码 效果图:","categories":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/categories/移动端学习/"}],"tags":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/tags/移动端学习/"}]},{"title":"前端马赛克学习","slug":"前端学习/马赛克学习","date":"2018-03-18T08:18:48.245Z","updated":"2018-05-17T13:45:31.367Z","comments":true,"path":"2018/03/18/前端学习/马赛克学习/","link":"","permalink":"https://pheromone.github.io/2018/03/18/前端学习/马赛克学习/","excerpt":"上周去菜市场买菜,看到路边一个二维码,于是想起阿里巴巴,接着想起之前上班都会路过阿里巴巴,接着想起马云,然后想到马赛克!!!于是我回家了,想学习下前端中的马赛克.","text":"上周去菜市场买菜,看到路边一个二维码,于是想起阿里巴巴,接着想起之前上班都会路过阿里巴巴,接着想起马云,然后想到马赛克!!!于是我回家了,想学习下前端中的马赛克.完成的功能 选择当地一张图片 点击绘制马赛克 拖动绘制马赛克 为了方便,相关js代码直接写在了index.html中,大致分为加载图片,添加监听,方法触发,绘制小方块(马赛克),计算颜色,数组升维这几个方法,UI部分通过canvas 标签和input 标签绘制.下面是完整的index.html代码 &lt;!doctype html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;/title&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;Keywords&quot; content=&quot;马赛克 canvas&quot;&gt; &lt;meta name=&quot;Description&quot; content=&quot;学习前端马赛克&quot;&gt; &lt;/head&gt; &lt;style&gt; canvas { border: 1px black solid; } &lt;/style&gt; &lt;body&gt; &lt;div id=&quot;mask&quot;&gt; &lt;canvas width=&quot;600&quot; height=&quot;600&quot;&gt; &lt;/canvas&gt; &lt;input type=&quot;file&quot; class=&apos;input&apos;&gt; &lt;/div&gt; &lt;script&gt; var canvas = document.querySelector(&apos;canvas&apos;); var input = document.querySelector(&apos;#mask .input&apos;); var ctx = canvas.getContext(&apos;2d&apos;); var mousedown = false; var t = 15; input.onchange = function () { loadimg(); } /** *加载图片 */ function loadimg() { var img = new Image(); img.src = window.URL.createObjectURL(input.files[0]); img.onload = function () { ctx.drawImage(img, 0, 0, 600, 600); } register(); } /** *添加监听 */ function register() { canvas.addEventListener(&apos;mousedown&apos;, action) canvas.addEventListener(&apos;mousemove&apos;, action) canvas.addEventListener(&apos;mouseup&apos;, action) } /** *方法触发 */ function action(e) { var dx = parseInt(((e.offsetX - t / 2) / t) * t) var dy = parseInt(((e.offsetY - t / 2) / t) * t) if (e.type == &quot;mousedown&quot;) { mousedown = true; computeColor(dx, dy); } if (mousedown &amp;&amp; e.type == &quot;mousemove&quot;) { computeColor(dx, dy); } if (e.type == &quot;mouseup&quot;) { mousedown = false; } } /* * 画小方块 */ function rect(x, y, c) { ctx.beginPath(); ctx.fillStyle = c; var dx = parseInt(x / t)*t,dy = parseInt(y / t)*t ctx.rect(dx, dy, t, t); ctx.fill(); } /** 计算颜色 */ function computeColor(x, y) { var arrList = restore(ctx.getImageData(x,y,t,t).data,4); //一维数组 var vr = 0, vg = 0, vb = 0,al = arrList.length; for(var i = 0; i &lt; al; i++){ vr += arrList[i][0]; vg += arrList[i][1]; vb += arrList[i][2]; var color = &apos;rgb(&apos; + Math.floor(vr/al) + &apos;,&apos; + Math.floor(vg/al) + &apos;,&apos; + Math.floor(vb/al) + &apos;)&apos;; rect(x,y,color); } } /** *数组升维 [1,2,3,4] =&gt; [[1,2],[3,4]] */ function restore(arr, step) { var list = []; var index = 0; var n = Math.floor(arr.length/step); for(var i = 0; i &lt; n ;i++){ list.push(arr.slice(index,index+step)); index += step; } return list; } &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; 效果图: 是不是特别棒,再也不为女朋友照片的隐私犯愁了.ps:现在就差个女朋友了 源码","categories":[{"name":"前端学习","slug":"前端学习","permalink":"https://pheromone.github.io/categories/前端学习/"}],"tags":[{"name":"前端学习","slug":"前端学习","permalink":"https://pheromone.github.io/tags/前端学习/"}]},{"title":"前端精灵图学习","slug":"前端学习/精灵图学习","date":"2018-03-18T08:18:48.245Z","updated":"2018-05-17T13:54:44.185Z","comments":true,"path":"2018/03/18/前端学习/精灵图学习/","link":"","permalink":"https://pheromone.github.io/2018/03/18/前端学习/精灵图学习/","excerpt":"今天学习下前端中的 精灵图.为何引入精灵图: 网页上面的每张图片都要经历一次请求才能展示给用户，小的图标频繁的请求服务器，降低页面的加载速度，为了有效地减少服务器接收和发送请求的次数，提高页面的加载速度，因此，产生了css精灵技术。","text":"今天学习下前端中的 精灵图.为何引入精灵图: 网页上面的每张图片都要经历一次请求才能展示给用户，小的图标频繁的请求服务器，降低页面的加载速度，为了有效地减少服务器接收和发送请求的次数，提高页面的加载速度，因此，产生了css精灵技术。以本地图片为例:精灵图使用其实就是对background-position:x y对图片进行偏移显示而已.下面是代码:12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;html&gt; &lt;head&gt; &lt;style&gt; *&#123; margin:0; padding:0; &#125; .div0&#123; margin:10px; &#125; .demo1,.demo2,.demo3,.demo4,.demo5,.demo6&#123; display:inline-block; width:17px; height:17px; background-color:transparent; background-image:url(img/精灵图.png); background-repeat:no-repeat; &#125; .demo1&#123; background-position:-38px -37px;&#125; .demo2&#123; background-position:-62px -37px;&#125; .demo3&#123; background-position:-86px -37px;&#125; .demo4&#123; background-position:-110px -37px;&#125; .demo5&#123; background-position:-134px -37px;&#125; .demo6&#123; background-position:-159px -37px;&#125; ul&#123; list-style:none; &#125; ul li &#123; margin:10px; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;div0&quot;&gt; &lt;ul&gt; &lt;li&gt;&lt;div class=&quot;demo1&quot;&gt;&lt;/div&gt; 图标1&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo2&quot;&gt;&lt;/div&gt; 图标2&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo3&quot;&gt;&lt;/div&gt; 图标3&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo4&quot;&gt;&lt;/div&gt; 图标4&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo5&quot;&gt;&lt;/div&gt; 图标5&lt;/li&gt; &lt;li&gt;&lt;div class=&quot;demo6&quot;&gt;&lt;/div&gt; 图标6&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; 效果图: 源码","categories":[{"name":"前端学习","slug":"前端学习","permalink":"https://pheromone.github.io/categories/前端学习/"}],"tags":[{"name":"前端学习","slug":"前端学习","permalink":"https://pheromone.github.io/tags/前端学习/"}]},{"title":"react-native-router-flux初步认识","slug":"移动端学习/react-native-router-flux初步认识","date":"2018-03-18T08:16:47.866Z","updated":"2018-05-25T18:49:34.276Z","comments":true,"path":"2018/03/18/移动端学习/react-native-router-flux初步认识/","link":"","permalink":"https://pheromone.github.io/2018/03/18/移动端学习/react-native-router-flux初步认识/","excerpt":"今天初步了解下 react-native-router-flux 这个三方导航库,基于react-native0.55.4,react-native-router-flux^4.0.0-beta.31","text":"今天初步了解下 react-native-router-flux 这个三方导航库,基于react-native0.55.4,react-native-router-flux^4.0.0-beta.31效果图:使用方法请参考:参考1参考2我这里不详细说明了,贴出关键代码一看便知.代码基本结构如下: App.js: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123;Component&#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View, Image&#125; from &apos;react-native&apos;;import &#123; Navigation, Scene, Router, Modal&#125; from &apos;react-native-router-flux&apos;;import IOS from &apos;./src/ios&apos;;import Android from &apos;./src/android&apos;import Web from &apos;./src/web&apos;import TabIcon from &apos;./src/TabIcon&apos;type Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;Router&gt; &lt;Modal&gt; &lt;Scene key=&quot;root&quot; tabBarPosition=&quot;bottom&quot; tabs&gt; &lt;Scene hideBackImage key=&quot;IOS&quot; title=&quot;苹果&quot; component=&#123;IOS&#125; icon=&#123;TabIcon&#125; Image=&#123;require(&apos;./src/image/ios.png&apos;)&#125; selectedImage=&#123;require(&apos;./src/image/ios_active.png&apos;)&#125; /&gt; &lt;Scene hideBackImage key=&quot;Web&quot; component=&#123;Web&#125; title=&quot;web&quot; icon=&#123;TabIcon&#125; Image=&#123;require(&apos;./src/image/web.png&apos;)&#125; showLabel = &#123;false&#125; selectedImage=&#123;require(&apos;./src/image/web_active.png&apos;)&#125; /&gt; &lt;Scene hideBackImage key=&quot;Android&quot; component=&#123;Android&#125; title=&quot;安卓&quot; icon=&#123;TabIcon&#125; Image=&#123;require(&apos;./src/image/android.png&apos;)&#125; hideNavBar=&#123;true&#125; //隐藏导航栏 selectedImage=&#123;require(&apos;./src/image/android_active.png&apos;)&#125; /&gt; &lt;/Scene&gt; &lt;/Modal&gt; &lt;/Router&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; tabbarContainer: &#123; flex: 1, backgroundColor: &quot;#f6f6f6&quot;, overflow: &apos;visible&apos; &#125;, tabIconItem: &#123; flex: 1, height: 56, flexDirection: &apos;column&apos;, alignItems: &apos;center&apos;, justifyContent: &apos;center&apos;, paddingLeft: 8, paddingRight: 8, backgroundColor: &apos;transparent&apos;, overflow: &apos;visible&apos; &#125;, tabIconImage: &#123; width: 60, height: 60, overflow: &apos;visible&apos; &#125;,&#125;); TabIcon.js 12345678910111213141516171819202122232425262728293031323334353637383940414243import React, &#123;PropTypes, Component&#125; from &apos;react&apos;import &#123;Text, View, Image, StyleSheet&#125; from &apos;react-native&apos;const tabIconStyles = StyleSheet.create(&#123; tabIconItem: &#123; flex: 1, height: 56, flexDirection: &apos;column&apos;, alignItems: &apos;center&apos;, justifyContent: &apos;center&apos;, paddingLeft: 8, paddingRight: 8, backgroundColor: &apos;transparent&apos;, &#125;, tabIconImage: &#123; width: 24, height: 24 &#125;, titleText: &#123; marginTop: 5, textAlign: &apos;center&apos;, fontSize: 11 &#125;, titleTextDefaultColor: &#123; color: &apos;black&apos; &#125;, titleTextSelectColor: &#123; color: &apos;red&apos; &#125;, tabItemRow: &#123; flexDirection: &apos;row&apos; &#125;,&#125;);export default TabIcon=(props)=&gt;&#123; return ( &lt;View style=&#123;tabIconStyles.tabIconItem&#125;&gt; &lt;Image style=&#123;tabIconStyles.tabIconImage&#125; source=&#123;props.focused ? props.selectedImage : props.Image&#125;/&gt; &lt;Text&gt;&#123;props.tabTitle&#125;&lt;/Text&gt; &lt;/View&gt; );&#125;; 而至于ios.js,web.js,android.js只是基本的模板界面 1234567891011121314151617181920212223242526272829303132333435363738394041424344/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View&#125; from &apos;react-native&apos;;type Props = &#123;&#125;;export default class IOS extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text style=&#123;styles.welcome&#125;&gt; 首页 &lt;/Text&gt; &lt;/View&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, instructions: &#123; textAlign: &apos;center&apos;, color: &apos;#333333&apos;, marginBottom: 5, &#125;,&#125;); 源码","categories":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/categories/移动端学习/"}],"tags":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/tags/移动端学习/"}]},{"title":"redux和react-navigation的结合使用","slug":"移动端学习/redux和react-navigation的结合使用","date":"2018-03-18T08:16:47.866Z","updated":"2018-05-15T18:42:12.750Z","comments":true,"path":"2018/03/18/移动端学习/redux和react-navigation的结合使用/","link":"","permalink":"https://pheromone.github.io/2018/03/18/移动端学习/redux和react-navigation的结合使用/","excerpt":"react-navigation 和 redux 的使用,这个网上很多.这里介绍下两者的结合使用.","text":"react-navigation 和 redux 的使用,这个网上很多.这里介绍下两者的结合使用.我代码的目录结构是: 使用的三方库是:1234567891011121314151617181920212223242526272829&#123; &quot;name&quot;: &quot;RN_nav&quot;, &quot;version&quot;: &quot;0.0.1&quot;, &quot;private&quot;: true, &quot;scripts&quot;: &#123; &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;, &quot;test&quot;: &quot;jest&quot; &#125;, &quot;dependencies&quot;: &#123; &quot;react&quot;: &quot;16.3.0-alpha.1&quot;, &quot;react-native&quot;: &quot;0.54.0&quot;, &quot;react-navigation&quot;: &quot;^1.5.1&quot;, &quot;react-navigation-redux-helpers&quot;: &quot;^1.0.3&quot;, &quot;react-redux&quot;: &quot;^5.0.7&quot;, &quot;redux&quot;: &quot;^3.7.2&quot;, &quot;redux-actions&quot;: &quot;^2.3.0&quot;, &quot;redux-logger&quot;: &quot;^3.0.6&quot;, &quot;redux-thunk&quot;: &quot;^2.2.0&quot; &#125;, &quot;devDependencies&quot;: &#123; &quot;babel-jest&quot;: &quot;22.4.1&quot;, &quot;babel-preset-react-native&quot;: &quot;4.0.0&quot;, &quot;jest&quot;: &quot;22.4.2&quot;, &quot;react-test-renderer&quot;: &quot;16.3.0-alpha.1&quot; &#125;, &quot;jest&quot;: &#123; &quot;preset&quot;: &quot;react-native&quot; &#125;&#125; 下面是各文件的源码.App.js1234567891011121314151617181920/** * Sample React Native App * https://github.com/facebook/react-native * @flow */import React,&#123; Component &#125; from &apos;react&apos;;import &#123;Provider&#125; from &apos;react-redux&apos;;import store from &apos;./src/store&apos;;import NavigatorPages from &apos;./src/AllPages/TabNavigatorPage&apos;;type Props = &#123;&#125;;export default class App extends Component&lt;Props&gt; &#123; render() &#123; return ( &lt;Provider store=&#123;store&#125;&gt; &lt;NavigatorPages/&gt; &lt;/Provider&gt; ); &#125;&#125; Allreducerstore.js123456789101112131415161718192021import &#123;createStore,applyMiddleware&#125; from &apos;redux&apos;;//中间件import logger from &apos;redux-logger&apos;;import thunk from &apos;redux-thunk&apos;;import &#123; createReduxBoundAddListener, createReactNavigationReduxMiddleware,&#125; from &apos;react-navigation-redux-helpers&apos;;//reducersimport reducers from &apos;./Allreducer/index&apos;;//引用react-navigation-redux-helpers组件手动创建中间件,接受state并返回新的state,让路由刷新// Note: createReactNavigationReduxMiddleware must be run before createReduxBoundAddListenerconst middleware = createReactNavigationReduxMiddleware( &quot;App&quot;, state =&gt; state.nav,);export const addListener = createReduxBoundAddListener(&quot;App&quot;);const middleWares = [middleware,thunk,logger];export default applyMiddleware(...middleWares)(createStore)(reducers); FirstPageReducer.js1234567891011121314151617181920212223import &#123;handleActions&#125; from &apos;redux-actions&apos;;const initialState = &#123; zglNum:0&#125;;export default handleActions(&#123; ADD:(state,action)=&gt;&#123; // alert(state.zglNum) return &#123; ...state, zglNum:state.zglNum + 1, secondState:&apos;iOS&apos; &#125; &#125;, SUB:(state,action)=&gt;&#123; return &#123; ...state, zglNum:state.zglNum - 1, secondState:&apos;Android&apos; &#125; &#125;&#125;,initialState); SecondPageReducer.js12345678910111213141516/** * Created by shaotingzhou on 2018/3/6. */import &#123;handleActions&#125; from &apos;redux-actions&apos;;const initialState = &#123; xxx:0&#125;;export default handleActions(&#123; SECOND:(state,action)=&gt;&#123; return &#123; ...state, xxx:2 &#125; &#125;,&#125;,initialState); index.js12345678910import &#123; combineReducers &#125; from &apos;redux&apos;;import TabNavigatorReducer from &apos;./TabNavigatorReducer&apos;;import FirstPageReducer from &apos;./FirstPageReducer&apos;;import SecondPageReducer from &apos;./SecondPageReducer&apos;;const reducers = combineReducers(&#123; TabNavigatorReducer, FirstPageReducer, SecondPageReducer,&#125;);export default reducers; AllPagesFirstPage.js12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485import React, &#123; PureComponent &#125; from &apos;react&apos;;import &#123; StyleSheet, Text, View, TouchableOpacity, Image&#125; from &apos;react-native&apos;;import &#123;connect&#125; from &apos;react-redux&apos;;import &#123;ADD,SUB&#125; from &apos;../Actions/FirstPageActions&apos;;class FirstPage extends PureComponent &#123; static navigationOptions = &#123; title:&apos;首页&apos;, &#125;; // componentWillUpdate()&#123; // alert(this.props.status); // // &#125; // componentDidUpdate()&#123; // alert(this.props.status); // &#125; // ES6 props // static defaultProps=&#123; // zglNum:0, // &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;TouchableOpacity onPress=&#123;()=&gt;&#123; this.props.dispatch(ADD()); &#125;&#125; &gt; &lt;Text style=&#123;styles.welcome&#125;&gt; + &lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;Text style=&#123;styles.welcome&#125;&gt; &#123;this.props.zglNum&#125; &lt;/Text&gt; &lt;TouchableOpacity onPress=&#123;()=&gt;&#123; this.props.dispatch(SUB()); &#125;&#125; &gt; &lt;Text style=&#123;styles.welcome&#125;&gt; - &lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ); &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, textView: &#123; fontSize: 16, textAlign: &apos;center&apos;, margin: 10, color:&apos;red&apos; &#125;,&#125;);const mapStateToProps = (store)=&gt;(&#123; zglNum: store.FirstPageReducer.zglNum //数字&#125;);export default connect(mapStateToProps)(FirstPage); SecondPage.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import React, &#123; PureComponent &#125; from &apos;react&apos;;import &#123; StyleSheet, Text, View, TouchableOpacity, Image&#125; from &apos;react-native&apos;;import &#123;connect&#125; from &apos;react-redux&apos;;import &#123;SECOND&#125; from &apos;../Actions/SecondPageActions&apos;;class SecondPage extends PureComponent &#123; static navigationOptions = &#123; title:&apos;第二&apos; &#125;; // ES6 props static defaultProps=&#123; secondState:&apos;默认&apos;, &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125; &gt; &lt;Text onPress=&#123;()=&gt;this.onClick()&#125;&gt;&#123;this.props.secondState&#125;&lt;/Text&gt; &lt;/View&gt; ); &#125; onClick =() =&gt;&#123; this.props.navigation.navigate(&apos;Snnn&apos;) &#125;&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: &apos;center&apos;, alignItems: &apos;center&apos;, backgroundColor: &apos;#F5FCFF&apos;, &#125;, welcome: &#123; fontSize: 20, textAlign: &apos;center&apos;, margin: 10, &#125;, textView: &#123; fontSize: 16, textAlign: &apos;center&apos;, margin: 10, color:&apos;red&apos; &#125;,&#125;);const mapStateToProps = (store)=&gt;(&#123; secondState:store.FirstPageReducer.secondState&#125;);export default connect(mapStateToProps)(SecondPage); NavigatorPage.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105import React, &#123; Component &#125; from &apos;react&apos;;import &#123; StyleSheet, Text, View, TouchableOpacity, Image&#125; from &apos;react-native&apos;;import FirstPage from &apos;./FirstPage&apos;;import SecondPage from &apos;./SecondPage&apos;;import &#123;connect&#125; from &apos;react-redux&apos;;import Snnn from &apos;./Snnn&apos;import &#123; StackNavigator, addNavigationHelpers, TabNavigator,&#125; from &apos;react-navigation&apos;;import &#123;addListener&#125; from &apos;../store&apos;;class NavigatorPages extends Component&#123; constructor(props)&#123; super(props); &#125; render()&#123; return( &lt;SimpleAppNavigator navigation=&#123;addNavigationHelpers(&#123; dispatch: this.props.dispatch, state: this.props.nav, addListener &#125;)&#125; /&gt; ) &#125;&#125;const Tab = TabNavigator(&#123; page1: &#123; screen: FirstPage, navigationOptions: (&#123; navigation &#125;) =&gt; (&#123; tabBarLabel: &apos;苹果233&apos;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? require(&apos;../../image/one_selected.png&apos;) : require(&apos;../../image/one.png&apos;)&#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ) &#125;), &#125;, page2: &#123; screen: SecondPage, navigationOptions: (&#123; navigation &#125;) =&gt; (&#123; tabBarLabel: &apos;安卓&apos;, tabBarIcon: (&#123; focused, tintColor &#125;) =&gt; ( &lt;Image source=&#123;focused ? require(&apos;../../image/two_selected.png&apos;) : require(&apos;../../image/two.png&apos;) &#125; style=&#123;&#123; width: 25, height: 25 &#125;&#125; /&gt; ) &#125;), &#125;,&#125;,&#123; initialRouteName: &apos;page1&apos;, swipeEnabled: true, animationEnabled: true, tabBarPosition:&apos;bottom&apos;, lazy: false, tabBarOptions: &#123; showIcon: true, activeTintColor: &apos;#979797&apos;, inactiveTintColor: &apos;#979797&apos;, style: &#123; backgroundColor: &apos;#ffffff&apos; &#125;, &#125;&#125;);export const SimpleAppNavigator = StackNavigator(&#123; Tab: &#123; screen: Tab, &#125;, page1 : &#123; screen: FirstPage, &#125;, page2 : &#123; screen: SecondPage &#125;, Snnn : &#123; screen: Snnn &#125;&#125;);const mapStateToProps = (store)=&gt;(&#123; nav : store.TabNavigatorReducer,&#125;);export default connect(mapStateToProps)(NavigatorPages); ActionsActionsTypes.js12345//Tab1export const ADD = &apos;ADD&apos;;export const SUB = &apos;SUB&apos;;//Tab2 FirstPageActions.js1234import &#123;createAction&#125; from &apos;redux-actions&apos;;import * as TYPES from &apos;./ActionTypes&apos;;export const ADD = createAction(TYPES.ADD);export const SUB = createAction(TYPES.SUB); SccondPageActions.js12345/** * Created by shaotingzhou on 2018/3/6. */import &#123;createAction&#125; from &apos;redux-actions&apos;;import * as TYPES from &apos;./ActionTypes&apos;; 源码效果图:","categories":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/categories/移动端学习/"}],"tags":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/tags/移动端学习/"}]},{"title":"react-navigation的基本使用","slug":"移动端学习/react-navigation的基本使用","date":"2018-03-18T06:50:06.825Z","updated":"2018-05-15T18:41:51.541Z","comments":true,"path":"2018/03/18/移动端学习/react-navigation的基本使用/","link":"","permalink":"https://pheromone.github.io/2018/03/18/移动端学习/react-navigation的基本使用/","excerpt":"本文基于npm 5.6.6 react-native-li 2.0.1 react-native 0.54.0 react-navigation ^1.4.0所写.","text":"本文基于npm 5.6.6 react-native-li 2.0.1 react-native 0.54.0 react-navigation ^1.4.0所写.实现的基本功能 tabBar 导航栏 在static中使用this 回调 跳多级界面 防止连续点击多次跳转界面并且上面这些方法均未修改三方库的源码,原先需要修改源码实现:原版对于react-navigation的使用看官方文档即可.防止连续点击多次跳转界面 通过state判断:先定义个state waiting 为 false ,再定义点击事件的 disabled={this.state.waiting} ,在响应方法里面先行修改statewaiting 为 true,然后跳转界面,最后在下方定一个计时器,2秒后再次修改state 为false 即可.完整代码: 123456789101112131415161718192021222324252627282930313233343536373839404142434445import React, &#123; Component &#125; from &apos;react&apos;;import &#123; Platform, StyleSheet, Text, View, Image, TouchableOpacity&#125; from &apos;react-native&apos;;type Props = &#123;&#125;;export default class OneDetails extends Component&lt;Props&gt; &#123; // 构造 constructor(props) &#123; super(props); // 初始状态 this.state = &#123; waiting:false//防止多次重复点击 &#125;; &#125; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;TouchableOpacity onPress=&#123;()=&gt;this.onclickBtn()&#125; disabled=&#123;this.state.waiting&#125;&gt; &lt;Text&gt;点击跳转&lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ); &#125; onclickBtn =() =&gt;&#123; this.setState(&#123;waiting: true&#125;); this.props.navigation.navigate(&apos;OneDetailsFlat&apos;) setTimeout(()=&gt; &#123; this.setState(&#123;waiting: false&#125;) &#125;, 2000);//2秒后重置state中的waiting状态 &#125;&#125; 在static中使用this 先在componentDidMount里123456//设置在static中使用this componentDidMount()&#123; this.props.navigation.setParams(&#123; navigatePress:this.navigatePress &#125;) &#125; 然后就可以:123456789static navigationOptions = (&#123; navigation, screenProps &#125;) =&gt; (&#123; title: &apos;ListView&apos;, headerStyle:&#123;backgroundColor:&apos;red&apos;&#125;, headerRight:( &lt;Text onPress=&#123;()=&gt;navigation.state.params.navigatePress()&#125;&gt; 点击 &lt;/Text&gt; ) &#125;); 使用:1234//导航条按钮点击 navigatePress = () =&gt; &#123; alert(this.state.text) &#125; 回调 在A push 到 B的时候先行定义个方法,然后在B pop 回A调用即可.A -&gt; B1234567891011//导航条按钮点击navigatePress = () =&gt; &#123; this.props.navigation.navigate(&apos;OneDetailsFlatDetails&apos;,&#123; // 跳转的时候携带一个参数去下个页面 callback: (data)=&gt;&#123; alert(data) &#125; &#125;);&#125; B -&gt; A1234popTwo =() =&gt;&#123; this.props.navigation.state.params.callback(&apos;回调参数&apos;); this.props.navigation.goBack() &#125; 回到首页 this.props.navigation.popToTop()回到相应页 this.props.navigation.pop(2)效果图: 源码","categories":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/categories/移动端学习/"}],"tags":[{"name":"移动端学习","slug":"移动端学习","permalink":"https://pheromone.github.io/tags/移动端学习/"}]}]}